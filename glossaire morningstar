from bs4 import BeautifulSoup
import pandas as pd 
import numpy as np
from my import *
import openpyxl

#二次修改，上面无解

import string  #导入string这个模块

headers = my_headers()  #fx
urls = []
for i in string.ascii_uppercase:
    url = "https://lt.morningstar.com/ls5tb3ppxc/Glossary/default.aspx?LanguageId=fr-FR&group={}".format(i)
    urls.append(url)
print(urls)

name_ = []
content_ = []
for url in urls:
    """
    获取所有网址链接
    """
    html = demande_html(url, headers).text  #fx
    html = BeautifulSoup(html)
    name = name + html.find_all("dt")
    ######### 订正：因为这里用for循环，i只有一个，所以使用find而不是find_all。否则name.string会报错。但是不用find_all则一条网址只会找到第一个标签。

    #print(name.string)
    #print(type(name.text))
    content = content + html.find_all('dd')
    #print(content)
    
    
dicall=[]
for x, y in zip(name, content):
    if name is not None and content is not None:
        dic=(x.get_text(),y.get_text())
        dicall.append(dic)
#print(dicall)
print(type(dicall))
dicall=pd.DataFrame(dicall)
print(type(dicall))
print(dicall.head())
dicall.to_excel(r'export/finance_dictionary.xlsx',sheet_name="dicall")
#         name_.append(x.text)
#         content_.append(y.text)
#         dictionary1 = pd.concat([dictionary1, pd.DataFrame(name_)])
#         dictionary2 = pd.concat([dictionary2, pd.DataFrame(content_)])
# dictionary1
# dictionary = pd.merge(dictionary1, dictionary2,left_on='')
# print(dictionary)
